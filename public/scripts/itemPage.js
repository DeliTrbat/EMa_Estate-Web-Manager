class ItemPage{static getProfileData(profileElement,accountID){let profile;var xmlHttpRequest=new XMLHttpRequest;xmlHttpRequest.open("GET","/api/profile?id="+accountID,!0),xmlHttpRequest.onreadystatechange=()=>{4==xmlHttpRequest.readyState&&200==xmlHttpRequest.status&&(profile=JSON.parse(xmlHttpRequest.responseText),profileElement.appendChild(ProfileContainer.create(profile)))},xmlHttpRequest.send()}static getWeatherData(itemInfo,lon,lat){var xmlHttpRequest=new XMLHttpRequest;xmlHttpRequest.open("GET",`/api/weather?lon=${lon}&lat=`+lat,!0),xmlHttpRequest.onreadystatechange=()=>{var weatherData;4==xmlHttpRequest.readyState&&200==xmlHttpRequest.status&&(weatherData=JSON.parse(xmlHttpRequest.responseText),itemInfo.appendChild(ItemInfo.addAditionalInfo(weatherData)))},xmlHttpRequest.send()}}DocumentHandler.whenReady(()=>{const profileElement=document.getElementsByClassName("content__right")[0],decriptionContainer=document.getElementsByClassName("content__box description")[0];var xmlHttpRequest=new XMLHttpRequest;let item;const searchParams=new URLSearchParams(window.location.search);xmlHttpRequest.open("GET","/api/item?id="+searchParams.get("id"),!0),xmlHttpRequest.onreadystatechange=()=>{if(4==xmlHttpRequest.readyState&&200==xmlHttpRequest.status){item=JSON.parse(xmlHttpRequest.responseText);var itemInfo=ItemInfo.create(item);profileElement.appendChild(itemInfo);const descriptionElement=createSimpleElement("p","pre");descriptionElement.innerHTML=item.description,decriptionContainer.appendChild(descriptionElement),Slideshow.create(item.imagesURLs),ItemPage.getProfileData(profileElement,item.accountID),ItemPage.getWeatherData(itemInfo,item.lon,item.lat),ProximityMapHandler.setTo(item.lon,item.lat)}},xmlHttpRequest.send()});class ProfileContainer{static create(data){const profileContainer=createSimpleElement("div","content__box content__box--profile"),{imageURL,lastName,firstName,businessName,createdAt,phone}=data,avatarContainer=createSimpleElement("div","content__box--profile__avatar"),nameElement=(avatarContainer.style.backgroundImage=`url("${imageURL}")`,createSimpleElement("h2","")),typeElement=(nameElement.textContent=lastName+" "+firstName+(null==businessName?"":" ("+businessName+")"),createSimpleElement("p","")),joinedElement=(typeElement.textContent=null==businessName?"Persoana fizicÄƒ":"Agent Imobiliar",createSimpleElement("p","secondary")),phoneContainer=(joinedElement.textContent="Pe Estence din "+createdAt,createSimpleElement("div","label label--flex label--important"));return phoneContainer.setAttribute("onclick",""),phoneContainer.onclick=()=>{var callTo="tel:"+phone;console.log(callTo),window.open(callTo)},phoneContainer.appendChild(createSimpleElement("span","icon icon-phone")),phoneContainer.appendChild(document.createTextNode(phone)),profileContainer.append(avatarContainer,nameElement,typeElement,joinedElement,phoneContainer),profileContainer}}let current=0;class Slideshow{static create(data){const carouselContainer=document.getElementsByClassName("content__box carousel")[0],slideshowContainer=createSimpleElement("div","slideshow-container"),dotsContainer=createSimpleElement("div","dots"),prevElement=(carouselContainer.append(slideshowContainer,dotsContainer),createSimpleElement("span","prev icon icon-prev")),nextElement=(prevElement.onclick=Slideshow.prevSlide,createSimpleElement("span","next icon icon-next"));nextElement.onclick=Slideshow.nextSlide,slideshowContainer.append(prevElement,nextElement);for(let index=0;index<data.length;index++){const imageContainer=createSimpleElement("div","slide fade image-container"),image=createSimpleElement("div","image"),dotElement=(image.style.backgroundImage=`url("${data[index]}")`,imageContainer.appendChild(image),imageContainer.style.display=0==index?"flex":"none",slideshowContainer.appendChild(imageContainer),createSimpleElement("span","dot"));dotElement.onclick=()=>{this.currentSlide(index)},dotsContainer.appendChild(dotElement)}}static currentSlide(no){current=no,Slideshow.showSlide(no)}static prevSlide(){Slideshow.showSlide(current-1)}static nextSlide(){Slideshow.showSlide(current+1)}static showSlide(no){var slides=document.getElementsByClassName("slide");const dots=document.getElementsByClassName("dot");(current=no)>=slides.length&&(current=0),no<0&&(current=slides.length-1);for(let i=0;i<slides.length;i++){const el=slides[i];el.style.display="none"}for(let i=0;i<dots.length;i++)dots[i].className=dots[i].className.replace(" active","");const el=slides[current];el.style.display="flex",dots[current].className+=" active"}}